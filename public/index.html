<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PROJE√á√ÉO ANALYTICS - Sistema Din√¢mico</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
    <header class="site-header">
        <div class="logo">
            <span class="logo-icon">üìä</span>
            PROJE√á√ÉO ANALYTICS
        </div>
        <div class="status-indicator">
            <span class="status-dot"></span>
            ONLINE
        </div>
    </header>

    <main class="main-layout">
        <section class="hero">
            <div class="hero-content">
                <div class="hero-logo-img" role="img" aria-label="Logo Proje√ß√£o Analytics">
                    <svg width="68" height="76" viewBox="0 0 68 76" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <defs>
                            <linearGradient id="heroGradient" x1="0" y1="0" x2="68" y2="0" gradientUnits="userSpaceOnUse">
                                <stop offset="0%" stop-color="#6AD9FF" />
                                <stop offset="50%" stop-color="#86A8FD" />
                                <stop offset="100%" stop-color="#F28AD9" />
                            </linearGradient>
                        </defs>
                        <rect x="14" y="6" width="40" height="36" rx="6" stroke="url(#heroGradient)" stroke-width="2" fill="none" />
                        <path d="M20 32 L28 24 L36 28 L44 18" stroke="url(#heroGradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                        <circle cx="44" cy="18" r="3" fill="url(#heroGradient)" />
                        <path d="M12 54 H56" stroke="url(#heroGradient)" stroke-width="3" stroke-linecap="round" />
                        <circle cx="34" cy="64" r="11" stroke="url(#heroGradient)" stroke-width="3" fill="none" />
                        <path d="M28 60 C32 62 36 62 40 60" stroke="url(#heroGradient)" stroke-width="2" fill="none" />
                        <path d="M28 68 C32 66 36 66 40 68" stroke="url(#heroGradient)" stroke-width="2" fill="none" />
                    </svg>
                </div>
                <p class="hero-title">An√°lise inteligente de apostas esportivas</p>
                <p class="hero-subtitle">Documento completo com indica√ß√µes, an√°lises, √∫ltima rodada e bingo especial</p>
            </div>
        </section>

        <section class="rodada-info">
            <div class="rodada-meta-card" id="rodada-meta-card">Carregando dados oficiais da rodada...</div>
            <div class="rodada-grid" id="rodada-grid"></div>
        </section>

        <div class="tabs-container">
            <div class="tabs-selector">
                <button class="tab-button active" data-tab="indicacoes">üìä Indica√ß√µes</button>
                <button class="tab-button" data-tab="analises">üîç An√°lises</button>
                <button class="tab-button" data-tab="ultima-rodada">üèÜ √öltima Rodada</button>
                <button class="tab-button" data-tab="outras-ligas">üåç Outras Ligas</button>
                <button class="tab-button" data-tab="bingo">üéØ Bingo</button>
            </div>
        </div>

        <div class="tabs-content">
            <section id="indicacoes" class="tab-content active">
                <div id="indicacoes-list" class="loading-block">Carregando indica√ß√µes...</div>
            </section>
            <section id="analises" class="tab-content">
                <div id="analises-list" class="loading-block">Selecione a aba para carregar as an√°lises.</div>
            </section>
            <section id="ultima-rodada" class="tab-content">
                <div id="ultima-rodada-content" class="loading-block">Carregando √∫ltima rodada...</div>
            </section>
            <section id="outras-ligas" class="tab-content">
                <div id="outras-ligas-content" class="loading-block">Carregando ligas internacionais...</div>
            </section>
            <section id="bingo" class="tab-content">
                <div id="bingo-list" class="loading-block">Carregando bingo especial...</div>
            </section>
        </div>
    </main>

    <script>
        let rodadaCache = null;
        let outrasLigasCache = null;
        let ligaSelecionada = 'premierLeague';

        document.addEventListener('DOMContentLoaded', () => {
            setupTabsSystem();
            loadRodadaInfo();
            loadIndicacoes();
            loadUltimaRodada();
            loadBingo();
        });

        async function loadRodadaInfo() {
            const metaCard = document.getElementById('rodada-meta-card');
            const grid = document.getElementById('rodada-grid');
            try {
                const response = await fetch('/data/rodada-completa.json');
                if (!response.ok) throw new Error('Falha ao carregar rodada');
                const data = await response.json();
                rodadaCache = data;
                renderRodadaInfo(data, metaCard, grid);
                verificarDadosAtualizados(data.data_atualizacao);
            } catch (error) {
                console.error(error);
                metaCard.textContent = 'Erro ao carregar dados da rodada.';
            }
        }

        function renderRodadaInfo(data, metaCard, grid) {
            const meta = data.documentacao || {};
            metaCard.innerHTML = `
                <h3>Rodada ${meta.rodada || ''}</h3>
                <p><strong>Vers√£o:</strong> ${data.versao_dados || '‚Äî'} ‚Ä¢ <strong>Atualiza√ß√£o:</strong> ${formatarDataISO(data.data_atualizacao)}</p>
                <p><strong>Respons√°vel:</strong> ${meta.responsavel || '‚Äî'}</p>
                <p class="rodada-alerta">${meta.observacao || ''}</p>
            `;

            if (!Array.isArray(data.rodadaCompleta)) {
                grid.innerHTML = '<p class="rodada-vazia">Rodada n√£o encontrada.</p>';
                return;
            }

            grid.innerHTML = data.rodadaCompleta.map((jogo) => {
                const statusClass = statusToClass(jogo.statusAnalise);
                return `
                    <article class="rodada-card">
                        <h4>${jogo.mandante} x ${jogo.visitante}</h4>
                        <p>üìÖ ${jogo.data} ‚Ä¢ ${jogo.horario}</p>
                        <span class="status-pill ${statusClass}">${jogo.statusAnalise}</span>
                    </article>
                `;
            }).join('');
        }

        function setupTabsSystem() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach((button) => {
                button.addEventListener('click', () => {
                    const tabName = button.dataset.tab;

                    tabButtons.forEach((btn) => btn.classList.remove('active'));
                    tabContents.forEach((content) => content.classList.remove('active'));

                    button.classList.add('active');
                    document.getElementById(tabName).classList.add('active');

                    if (tabName === 'analises') {
                        loadAnalises();
                    } else if (tabName === 'ultima-rodada') {
                        loadUltimaRodada();
                    } else if (tabName === 'outras-ligas') {
                        loadOutrasLigas();
                    } else if (tabName === 'bingo') {
                        loadBingo();
                    }
                });
            });
        }

        async function loadIndicacoes() {
            const container = document.getElementById('indicacoes-list');
            try {
                const response = await fetch('/data/indicacoes-proximas.json');
                if (!response.ok) throw new Error('Falha ao carregar indica√ß√µes');
                const data = await response.json();
                renderIndicacoes(data);
            } catch (error) {
                console.error(error);
                container.textContent = 'Erro ao carregar indica√ß√µes. Atualize a p√°gina para tentar novamente.';
            }
        }

        function renderIndicacoes(data) {
            const container = document.getElementById('indicacoes-list');
            if (!data || !Array.isArray(data.indicacoes)) {
                container.textContent = 'Nenhuma indica√ß√£o dispon√≠vel no momento.';
                return;
            }

            let html = `<div class="aviso-variabilidade">${data.aviso || ''}</div>`;

            html += data.indicacoes.slice(0, 6).map((aposta) => {
                const jogoBase = buscarJogoNaRodada(aposta.confronto);
                const status = jogoBase?.statusAnalise ? `<span class="status-pill ${statusToClass(jogoBase.statusAnalise)}">${jogoBase.statusAnalise}</span>` : '';
                const agenda = jogoBase ? `${jogoBase.data} ‚Ä¢ ${jogoBase.horario}` : (aposta.dias_distante || formatarData(aposta.data));

                return `
                    <article class="indicacao-card status-${aposta.status}">
                        <div class="indicacao-header">
                            <h3>${aposta.confronto}</h3>
                            <span class="status-badge ${aposta.status}">${aposta.status}</span>
                            ${status}
                        </div>
                        <div class="indicacao-meta">
                            <span class="campeonato">${aposta.campeonato}</span>
                            <span class="data">${agenda}</span>
                        </div>
                        <div class="indicacao-aposta">
                            <h4>${aposta.mercado}</h4>
                            <p><strong>Motivo:</strong> ${aposta.motivo}</p>
                            ${aposta.nota ? `<p><strong>Nota:</strong> ${aposta.nota}</p>` : ''}
                        </div>
                        <div class="indicacao-stats">
                            <div class="stat"><label>Odd justa</label><span>${aposta.odd_justa}</span></div>
                            <div class="stat"><label>Odd mercado</label><span>${aposta.odd_mercado}</span></div>
                            <div class="stat"><label>Value</label><span class="value-positive">${aposta.value}</span></div>
                            <div class="stat"><label>Confian√ßa</label><span>${aposta.confianca}</span></div>
                            <div class="stat"><label>Stake</label><span>${aposta.stake}</span></div>
                            <div class="stat"><label>Risco</label><span>${aposta.risco}</span></div>
                        </div>
                    </article>
                `;
            }).join('');

            if (data.resumo) {
                html += `
                    <div class="indicacoes-resumo">
                        <h3>üìä Resumo das Indica√ß√µes</h3>
                        <p><strong>Total de apostas:</strong> ${data.resumo.total_apostas}</p>
                        <p><strong>Stake recomendado:</strong> ${data.resumo.stake_total_recomendado}</p>
                        <p><strong>Taxa de sucesso esperada:</strong> ${data.resumo.taxa_sucesso_esperada}</p>
                        <p><strong>Value m√©dio:</strong> ${data.resumo.value_medio}</p>
                        <p><strong>Confian√ßa m√©dia:</strong> ${data.resumo.confianca_media}</p>
                        <p class="resumo-warning">${data.resumo.aviso_especial || ''}</p>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        async function loadAnalises() {
            const container = document.getElementById('analises-list');
            if (container.dataset.loaded === 'true') return;
            try {
                const response = await fetch('/data/analises-aprimoradas.json');
                if (!response.ok) throw new Error('Falha ao carregar an√°lises');
                const data = await response.json();
                renderAnalises(data);
                container.dataset.loaded = 'true';
            } catch (error) {
                console.error(error);
                container.textContent = 'Erro ao carregar an√°lises.';
            }
        }

        function renderAnalises(data) {
            const container = document.getElementById('analises-list');
            if (!data || !Array.isArray(data.analises)) {
                container.textContent = 'Nenhuma an√°lise dispon√≠vel.';
                return;
            }

            let html = '';
            if (data.nota_importante) {
                html += `
                    <div class="analises-banner">
                        <strong>üìù ${data.nota_importante}</strong>
                    </div>
                `;
            }

            html += data.analises.map((analise) => {
                const detailBlocks = Object.entries(analise)
                    .filter(([key, value]) => typeof value === 'object' && key !== 'contexto')
                    .map(([key, value]) => renderTeamBlock(value, key))
                    .join('');

                return `
                    <article class="analise-card">
                        <div class="analise-header">
                            <h3>${analise.titulo}</h3>
                            ${analise.statusAnalise ? `<span class="status-pill ${statusToClass(analise.statusAnalise)}">${analise.statusAnalise}</span>` : ''}
                        </div>
                        <p class="analise-meta">${analise.mandante} x ${analise.visitante} ‚Ä¢ ${analise.data} √†s ${analise.horario} ‚Ä¢ ${analise.local}</p>
                        <p><strong>Competi√ß√£o:</strong> ${analise.competicao}</p>
                        ${renderContexto(analise.contexto)}
                        ${detailBlocks}
                        ${analise.ajustesTaticos ? `<p class="analise-ajustes">${analise.ajustesTaticos}</p>` : ''}
                        <h4>Recomenda√ß√£o final</h4>
                        <p class="recomendacao">${analise.recomendacao}</p>
                        ${analise.cuidados ? `<p class="alerta">${analise.cuidados}</p>` : ''}
                        ${analise.alternativa ? `<p><strong>Alternativa:</strong> ${analise.alternativa}</p>` : ''}
                    </article>
                `;
            }).join('');

            container.innerHTML = html;
        }

        function renderTeamBlock(block, key) {
            if (!block || key === 'contexto') return '';
            let html = '<div class="analise-team-block">';
            const titulo = block.titulo || formatTeamKey(key);
            if (titulo) {
                html += `<h4>${titulo}</h4>`;
            }
            if (block.posicao) html += `<p><strong>Posi√ß√£o:</strong> ${block.posicao}</p>`;
            if (block.forma) html += `<p><strong>Forma:</strong> ${block.forma}</p>`;
            if (block.gols_temporada) html += `<p><strong>Gols na temporada:</strong> ${block.gols_temporada}</p>`;
            if (block.golsPorJogo) html += `<p><strong>Gols por jogo:</strong> ${block.golsPorJogo}</p>`;
            if (block.sequencia) html += `<p><strong>Sequ√™ncia:</strong> ${block.sequencia}</p>`;
            if (block.defesa) html += `<p><strong>Defesa:</strong> ${block.defesa}</p>`;
            if (block.ataque) html += `<p><strong>Ataque:</strong> ${block.ataque}</p>`;
            if (block.probabilidade_marcar) html += `<p><strong>Probabilidade de marcar:</strong> ${block.probabilidade_marcar}</p>`;
            if (block.probabilidadeMarcar) html += `<p><strong>Probabilidade de marcar:</strong> ${block.probabilidadeMarcar}</p>`;
            if (block.analise) html += `<p>${block.analise}</p>`;
            if (block.observacao) html += `<p>${block.observacao}</p>`;
            html += '</div>';
            return html;
        }

        function renderContexto(contexto = {}) {
            const entries = Object.entries(contexto)
                .filter(([, value]) => value)
                .map(([key, value]) => `<p><strong>${formatContextKey(key)}:</strong> ${value}</p>`) || [];
            if (!entries.length) return '';
            return `
                <div class="analise-contexto">
                    <h4>Contexto</h4>
                    ${entries.join('')}
                </div>
            `;
        }

        async function loadUltimaRodada() {
            const container = document.getElementById('ultima-rodada-content');
            try {
                const response = await fetch('/data/ultima-rodada.json');
                if (!response.ok) throw new Error('Falha ao carregar √∫ltima rodada');
                const data = await response.json();
                renderUltimaRodada(data);
            } catch (error) {
                console.error(error);
                container.textContent = 'Erro ao carregar informa√ß√µes da √∫ltima rodada.';
            }
        }

        function renderUltimaRodada(data) {
            const container = document.getElementById('ultima-rodada-content');
            if (!data || !Array.isArray(data.jogos)) {
                container.textContent = '√öltima rodada indispon√≠vel.';
                return;
            }

            const cabecalho = data.cabecalho || {};
            const jogosHtml = data.jogos.map(renderJogoCard).join('');
            const proximaRodada = renderProximaRodada(data.proxima_rodada);

            container.innerHTML = `
                <div class="ultima-rodada-header">
                    <h2>${cabecalho.titulo || ''}</h2>
                    <p class="destaque-campeonato">${cabecalho.destaque || ''}</p>
                    <p class="info-rodada">${cabecalho.info_rodada || ''}</p>
                    ${cabecalho.contexto ? `<p class="info-contexto">${cabecalho.contexto}</p>` : ''}
                </div>
                <div class="rodada-jogos-grid">
                    ${jogosHtml}
                </div>
                ${proximaRodada}
            `;
        }

        function renderJogoCard(jogo) {
            return `
                <article class="rodada37-card status-${(jogo.status || '').toLowerCase()}">
                    <div class="rodada37-header">
                        <h3>${jogo.titulo}</h3>
                        <span class="status-pill ${statusToClass(jogo.status)}">${jogo.status || ''}</span>
                    </div>
                    <p class="rodada37-meta">${jogo.data || ''}${jogo.horario ? ` ‚Ä¢ ${jogo.horario}` : ''} ‚Ä¢ ${jogo.local || ''}</p>
                    <p class="rodada37-placar">${jogo.resultado || ''}</p>
                    ${jogo.destaques ? `<p class="rodada37-destaque">${jogo.destaques}</p>` : ''}
                    <p>${jogo.analise || ''}</p>
                    ${jogo.impacto ? `<p class="rodada37-impacto">${jogo.impacto}</p>` : ''}
                </article>
            `;
        }

        function renderProximaRodada(info = {}) {
            if (!info.titulo) return '';
            const pendencias = Array.isArray(info.pendencias)
                ? info.pendencias.map((item) => `<li>${item}</li>`).join('')
                : '';

            return `
                <div class="nota-proxima-rodada">
                    <h3>${info.titulo}</h3>
                    <p><strong>Data:</strong> ${info.data || ''}</p>
                    <p><strong>Situa√ß√£o:</strong> ${info.contexto || ''}</p>
                    ${pendencias ? `<ul>${pendencias}</ul>` : ''}
                    <p class="alerta">${info.alerta || ''}</p>
                </div>
            `;
        }

        async function loadBingo() {
            const container = document.getElementById('bingo-list');
            try {
                const response = await fetch('/data/bingo-10-mercados.json');
                if (!response.ok) throw new Error('Falha ao carregar bingo');
                const data = await response.json();
                renderBingo(data);
            } catch (error) {
                console.error(error);
                container.textContent = 'Erro ao carregar bingo do dia.';
            }
        }

        function renderBingo(data) {
            const container = document.getElementById('bingo-list');
            if (!data || !Array.isArray(data.mercados)) {
                container.textContent = 'Bingo indispon√≠vel.';
                return;
            }

            const jogos = Array.isArray(data.jogos_programados)
                ? data.jogos_programados.map((jogo) => `<li>${jogo}</li>`).join('')
                : '';

            const mercados = data.mercados.slice(0, 10).map((mercado) => `
                <article class="bingo-mercado">
                    <div class="numero">${mercado.numero}</div>
                    <h3>${mercado.titulo}</h3>
                    <p><strong>Jogo:</strong> ${mercado.jogo}</p>
                    <p><strong>Hora:</strong> ${mercado.hora}</p>
                    <p><strong>Confian√ßa:</strong> ${mercado.confianca}%</p>
                    <p><strong>Value:</strong> ${mercado.odds.value}</p>
                    <p><strong>Risco:</strong> ${mercado.risco}</p>
                    <p class="bingo-motivo">${mercado.motivo}</p>
                </article>
            `).join('');

            container.innerHTML = `
                <div class="bingo-header">
                    <h1>${data.titulo}</h1>
                    <p>${data.data}</p>
                    <p class="bingo-aviso">${data.aviso}</p>
                </div>
                <div class="bingo-programacao">
                    <h3>üìÖ Jogos programados</h3>
                    <ul>${jogos}</ul>
                </div>
                <div class="bingo-mercados">${mercados}</div>
                <div class="bingo-resumo">
                    <h2>üéØ Resumo</h2>
                    <p><strong>Total de mercados:</strong> ${data.resumo_bingo?.total_mercados || ''}</p>
                    <p><strong>Stake recomendado:</strong> ${data.resumo_bingo?.valor_stake_recomendado || ''}</p>
                    <p><strong>Taxa de sucesso esperada:</strong> ${data.resumo_bingo?.taxa_sucesso_esperada || ''}</p>
                    <p><strong>Value m√©dio:</strong> ${data.resumo_bingo?.value_medio || ''}</p>
                    <p><strong>Confian√ßa m√©dia:</strong> ${data.resumo_bingo?.confianca_media || ''}</p>
                    <p><strong>Maior value:</strong> ${data.resumo_bingo?.maior_value || ''}</p>
                    <p><strong>Melhor rela√ß√£o:</strong> ${data.resumo_bingo?.melhor_relacao || ''}</p>
                    <p class="bingo-aviso-final">${data.resumo_bingo?.aviso_final || ''}</p>
                </div>
            `;
        }

        async function loadOutrasLigas() {
            const container = document.getElementById('outras-ligas-content');
            if (outrasLigasCache) {
                renderOutrasLigas();
                return;
            }
            try {
                const response = await fetch('/data/outras-ligas.json');
                if (!response.ok) throw new Error('Falha ao carregar outras ligas');
                outrasLigasCache = await response.json();
                renderOutrasLigas();
            } catch (error) {
                console.error(error);
                container.textContent = 'Erro ao carregar ligas internacionais.';
            }
        }

        function renderOutrasLigas(selectedKey = ligaSelecionada) {
            const container = document.getElementById('outras-ligas-content');
            if (!outrasLigasCache || !outrasLigasCache.ligas) {
                container.textContent = 'Dados indispon√≠veis.';
                return;
            }

            const ligas = outrasLigasCache.ligas;
            const keys = Object.keys(ligas);
            if (!keys.length) {
                container.textContent = 'Nenhuma liga cadastrada.';
                return;
            }

            if (!ligas[selectedKey]) {
                selectedKey = keys[0];
            }
            ligaSelecionada = selectedKey;
            const liga = ligas[selectedKey];

            const menu = keys.map((key) => {
                const atual = ligas[key];
                const ativo = key === selectedKey ? 'ativo' : '';
                return `<button class="liga-button ${ativo}" data-liga="${key}">${atual.logo || ''} ${atual.nome}</button>`;
            }).join('');

            const jogosPanel = renderJogosRodadaPanel(liga);
            const analisesDetalhadas = renderAnalisesLiga(liga);

            container.innerHTML = `
                <div class="outras-ligas-container">
                    <div class="ligas-menu">${menu}</div>
                    <div class="liga-header">
                        <h2>${liga.logo || ''} ${liga.nome}</h2>
                        <p class="liga-info"><strong>Pa√≠s:</strong> ${liga.pais} ‚Ä¢ <strong>Rodada:</strong> ${liga.rodadaAtual} ‚Ä¢ <strong>Data:</strong> ${liga.dataRodada}</p>
                    </div>
                    ${jogosPanel}
                    ${analisesDetalhadas}
                </div>
            `;

            container.querySelectorAll('[data-liga]').forEach((button) => {
                button.addEventListener('click', (event) => {
                    const targetLiga = event.currentTarget.dataset.liga;
                    if (targetLiga && targetLiga !== ligaSelecionada) {
                        renderOutrasLigas(targetLiga);
                    }
                });
            });
        }

        function renderJogosRodadaPanel(liga) {
            if (!Array.isArray(liga.jogosRodada)) return '';
            const jogos = liga.jogosRodada.map((jogo) => {
                const statusDisponivel = jogo.statusAnalise === 'dispon√≠vel';
                return `
                    <div class="jogo-card ${statusDisponivel ? 'disponivel' : 'pendente'}">
                        <div class="jogo-times">
                            <span class="mandante">${jogo.mandante}</span>
                            <span class="vs">x</span>
                            <span class="visitante">${jogo.visitante}</span>
                        </div>
                        <div class="jogo-info">
                            <span class="data">üìÖ ${jogo.data} ‚Ä¢ ${jogo.horario}</span>
                            ${jogo.importancia ? `<span class="importancia">${jogo.importancia}</span>` : ''}
                        </div>
                        <div class="status-badge ${statusDisponivel ? 'badge-disponivel' : 'badge-pendente'}">
                            ${statusDisponivel ? '‚úÖ An√°lise dispon√≠vel' : '‚è≥ Pendente'}
                        </div>
                    </div>
                `;
            }).join('');

            return `
                <div class="jogos-rodada-panel">
                    <h3>üìÖ Jogos da Rodada ${liga.rodadaAtual}</h3>
                    <div class="jogos-grid">${jogos}</div>
                </div>
            `;
        }

        function renderAnalisesLiga(liga) {
            if (!Array.isArray(liga.analises) || !liga.analises.length) {
                return '<p class="sem-analises">Nenhuma an√°lise dispon√≠vel para esta liga.</p>';
            }

            const cards = liga.analises.map((analise) => {
                const mandanteInfo = renderTimeInfo(analise.mandante_info, 'mandante');
                const visitanteInfo = renderTimeInfo(analise.visitante_info, 'visitante');
                const contexto = analise.contexto ? renderAnaliseContexto(analise.contexto) : '';
                return `
                    <article class="analise-card internacional">
                        <h4>${analise.titulo}</h4>
                        <div class="analise-header">
                            <span class="competicao">${analise.competicao}</span>
                            <span class="data-hora">üìÖ ${analise.data} ‚Ä¢ ${analise.horario}</span>
                            <span class="local">üìç ${analise.local}</span>
                        </div>
                        ${contexto}
                        ${mandanteInfo}
                        ${visitanteInfo}
                        ${analise.ajustesTaticos ? `<div class="ajustes-taticos"><h6>‚öôÔ∏è Ajustes T√°ticos</h6><p>${analise.ajustesTaticos}</p></div>` : ''}
                        <div class="recomendacoes">
                            <div class="recomendacao-principal">
                                <h6>üí° Recomenda√ß√£o Principal</h6>
                                <p>${analise.recomendacao}</p>
                            </div>
                            ${analise.alternativa ? `<div class="recomendacao-alternativa"><h6>üîÑ Alternativa</h6><p>${analise.alternativa}</p></div>` : ''}
                        </div>
                        ${analise.observacoes ? `<div class="observacoes"><p><strong>‚ö†Ô∏è Observa√ß√µes:</strong> ${analise.observacoes}</p></div>` : ''}
                    </article>
                `;
            }).join('');

            return `
                <div class="analises-section">
                    <h3>üîç An√°lises Detalhadas</h3>
                    ${cards}
                </div>
            `;
        }

        function renderTimeInfo(info, tipo) {
            if (!info) return '';
            const { nome, ...rest } = info;
            const icon = tipo === 'mandante' ? 'üè†' : '‚úàÔ∏è';
            const rows = Object.entries(rest).map(([key, value]) => `<p><strong>${formatContextKey(key)}:</strong> ${value}</p>`).join('');
            return `
                <div class="time-info ${tipo === 'mandante' ? 'mandante-info' : 'visitante-info'}">
                    <h5>${icon} ${nome || ''}</h5>
                    ${rows}
                </div>
            `;
        }

        function renderAnaliseContexto(contexto) {
            const rows = Object.entries(contexto)
                .filter(([, value]) => value)
                .map(([key, value]) => `<p><strong>${formatContextKey(key)}:</strong> ${value}</p>`)
                .join('');
            if (!rows) return '';
            return `<div class="contexto">${rows}</div>`;
        }

        function formatarData(dataIso) {
            if (!dataIso) return '';
            const date = new Date(dataIso);
            return date.toLocaleDateString('pt-BR', {
                weekday: 'short',
                day: '2-digit',
                month: 'short',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function formatarDataISO(isoString) {
            if (!isoString) return '‚Äî';
            return new Date(isoString).toLocaleString('pt-BR', { dateStyle: 'short', timeStyle: 'short' });
        }

        function formatTeamKey(key) {
            if (!key) return '';
            return key
                .replace(/([a-z])([A-Z])/g, '$1 $2')
                .replace(/_/g, ' ')
                .replace(/\b\w/g, (char) => char.toUpperCase());
        }

        function formatContextKey(key) {
            return formatTeamKey(key);
        }

        function normalizarNome(nome) {
            return (nome || '')
                .toLowerCase()
                .normalize('NFD')
                .replace(/[^a-z0-9\s]/g, '')
                .trim();
        }

        function buscarJogoNaRodada(confronto) {
            if (!rodadaCache || !Array.isArray(rodadaCache.rodadaCompleta)) return null;
            if (!confronto) return null;
            const partes = confronto.split('x');
            if (partes.length !== 2) return null;
            const mandante = normalizarNome(partes[0]);
            const visitante = normalizarNome(partes[1]);
            return rodadaCache.rodadaCompleta.find((jogo) => {
                return normalizarNome(jogo.mandante) === mandante && normalizarNome(jogo.visitante) === visitante;
            }) || null;
        }

        function verificarDadosAtualizados(dataIso) {
            if (!dataIso) return;
            const agora = Date.now();
            const ultimaAtualizacao = new Date(dataIso).getTime();
            const horas = (agora - ultimaAtualizacao) / 36e5;
            if (horas > 24) {
                console.warn('‚ö†Ô∏è ATEN√á√ÉO: Dados podem estar desatualizados!');
            }
        }

        function statusToClass(status) {
            if (!status) return '';
            return `status-${status
                .toLowerCase()
                .normalize('NFD')
                .replace(/[^a-z0-9]+/g, '-')}`;
        }
    </script>
</body>
</html>
